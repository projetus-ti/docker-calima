{"version":3,"sources":["views/pages/ger/usuario/UsuarioSearchView.tsx","../node_modules/reactstrap/es/Alert.js","models/dtos/ger/usuario.ts"],"names":["cellEditProps","blurToSave","mode","ClickEnum","CLICK","UsuarioSearchView","props","searchRef","useRef","globalReducer","useSelector","state","_useState","useState","_useState2","Object","C_Program_Files_x86_Jenkins_workspace_Calima_react_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","existeUsuarioNaoSincronizado","setExisteUsuarioNaoSincronizado","dispatch","useDispatch","columns","dataField","editable","filter","type","FilterType","TEXT","sort","text","DATE","boolColumn","editor","mostrarMensagem","mensagem","alertManager","emit","ACTION_EVENTS","SHOW","message","AlertType","ERROR","callSincronizacao","sincronizarUsuariosWS","errorFunction","showToast","thenFunction","progressActions","hideProgress","current","notifySearchExpressionChange","INFORMATION","useEffect","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","summer__WEBPACK_IMPORTED_MODULE_4__","title","useGlobalParameter","globalParameter","wikiId","reactstrap__WEBPACK_IMPORTED_MODULE_3__","color","className","assign","searchDataGridProps","dtoClassName","CLASS_NAME","extraData","getExtraData","customRemove","selectedItem","usuario","setTimeout","administrador","id","nomeCompleto","showProgress","animated","label","striped","value","removerUsuario","ref","rowClasses","row","dtSincronizacao","_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__","_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","react__WEBPACK_IMPORTED_MODULE_3__","react__WEBPACK_IMPORTED_MODULE_3___default","n","prop_types__WEBPACK_IMPORTED_MODULE_4__","prop_types__WEBPACK_IMPORTED_MODULE_4___default","classnames__WEBPACK_IMPORTED_MODULE_5__","classnames__WEBPACK_IMPORTED_MODULE_5___default","_utils__WEBPACK_IMPORTED_MODULE_6__","_Fade__WEBPACK_IMPORTED_MODULE_7__","propTypes","children","node","string","closeClassName","closeAriaLabel","cssModule","object","fade","bool","isOpen","toggle","func","tag","transition","shape","innerRef","oneOfType","defaultProps","unmountOnExit","Alert","Tag","attributes","classes","alert-dismissible","closeClasses","alertTransition","baseClass","timeout","in","role","aria-label","onClick","aria-hidden","__webpack_exports__","d"],"mappings":"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","file":"static/js/312.67859b4a.chunk.js","sourcesContent":["import React, { FC, useEffect, useRef, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Alert } from 'reactstrap';\r\nimport {\r\n  ACTION_EVENTS,\r\n  alertManager,\r\n  AlertType,\r\n  boolColumn,\r\n  CellEditProps,\r\n  ClickEnum,\r\n  ColumnsProps,\r\n  ERROR,\r\n  FilterType,\r\n  getExtraData,\r\n  INFORMATION,\r\n  progressActions,\r\n  SearchDataGrid,\r\n  SearchDataGridRefProps,\r\n  SearchViewProps,\r\n  showToast,\r\n  WindowComponent,\r\n} from 'summer';\r\nimport { CLASS_NAME, Usuario } from '../../../../models/dtos/ger/usuario';\r\nimport { removerUsuario, sincronizarUsuariosWS } from '../../../../services/ger.service';\r\nimport { Reducers } from '../../../../store/ducks';\r\nimport { GlobalState } from '../../../../store/ducks/global.duck';\r\nimport './UsuarioStyle.css';\r\n\r\nconst cellEditProps: CellEditProps = {\r\n  blurToSave: true,\r\n  mode: ClickEnum.CLICK,\r\n};\r\n\r\nconst UsuarioSearchView: FC<SearchViewProps<Usuario>> = props => {\r\n  const searchRef = useRef<SearchDataGridRefProps>();\r\n  const globalReducer = useSelector<Reducers, GlobalState>(state => state.globalReducer);\r\n  const [existeUsuarioNaoSincronizado, setExisteUsuarioNaoSincronizado] = useState(false);\r\n  const dispatch = useDispatch();\r\n\r\n  const columns: ColumnsProps[] = [\r\n    {\r\n      dataField: 'nomeCompleto',\r\n      editable: false,\r\n      filter: {\r\n        type: FilterType.TEXT,\r\n      },\r\n      sort: true,\r\n      text: 'Nome Completo',\r\n    },\r\n    {\r\n      dataField: 'login',\r\n      editable: false,\r\n      filter: {\r\n        type: FilterType.TEXT,\r\n      },\r\n      sort: true,\r\n      text: 'Usuário',\r\n    },\r\n    {\r\n      dataField: 'cpf',\r\n      editable: false,\r\n      filter: {\r\n        type: FilterType.TEXT,\r\n      },\r\n      sort: true,\r\n      text: 'CPF',\r\n    },\r\n    {\r\n      dataField: 'email',\r\n      filter: {\r\n        type: FilterType.DATE,\r\n      },\r\n      sort: true,\r\n      text: 'E-mail',\r\n    },\r\n    {\r\n      dataField: 'dtInatividade',\r\n      filter: {\r\n        type: FilterType.DATE,\r\n      },\r\n      sort: true,\r\n      text: 'Dt.Inat.',\r\n    },\r\n    boolColumn({\r\n      dataField: 'administrador',\r\n      editor: false,\r\n      filter: true,\r\n      sort: true,\r\n      text: 'É Administrador?',\r\n    }),\r\n    {\r\n      dataField: 'perfil.descricao',\r\n      filter: {\r\n        type: FilterType.TEXT,\r\n      },\r\n      sort: true,\r\n      text: 'Perfil',\r\n    },\r\n  ];\r\n\r\n  function getRowClass(row) {\r\n    if (!row.dtSincronizacao) {\r\n      setExisteUsuarioNaoSincronizado(true);\r\n      return 'cor-usuario-erro';\r\n    }\r\n  }\r\n\r\n  const mostrarMensagem = (mensagem: string) => {\r\n    alertManager.emit(ACTION_EVENTS.SHOW, {\r\n      message: mensagem,\r\n      type: AlertType.ERROR,\r\n    });\r\n  };\r\n\r\n  const customRemove = (selectedItem: Usuario) => {\r\n    const { usuario } = globalReducer.globalParameter;\r\n\r\n    setTimeout(() => {\r\n      if (usuario.administrador) {\r\n        if (selectedItem.id === usuario.id) {\r\n          mostrarMensagem('Não é possível excluir o usuário logado.');\r\n        } else if (selectedItem.administrador) {\r\n          mostrarMensagem('Não é possível excluir o usuário ' + selectedItem.nomeCompleto + ', pois o mesmo é um administrador');\r\n        } else {\r\n          dispatch(\r\n            progressActions.showProgress({\r\n              animated: true,\r\n              className: 'progress-bar-rounded progress-animated-alt',\r\n              color: 'first',\r\n              label: 'Deletando usuário...',\r\n              striped: true,\r\n              value: 100,\r\n            })\r\n          );\r\n\r\n          removerUsuario(selectedItem, {\r\n            errorFunction: mensagem => {\r\n              showToast(mensagem, ERROR);\r\n            },\r\n            thenFunction: () => {\r\n              callSincronizacao();\r\n            },\r\n          });\r\n        }\r\n      } else {\r\n        mostrarMensagem('O usuário não tem permissão suficiente para executar essa ação.');\r\n      }\r\n    }, 100);\r\n  };\r\n\r\n  const callSincronizacao = () => {\r\n    sincronizarUsuariosWS({\r\n      errorFunction: mensagem => {\r\n        showToast(mensagem, ERROR);\r\n      },\r\n      thenFunction: () => {\r\n        dispatch(progressActions.hideProgress());\r\n        searchRef.current.notifySearchExpressionChange();\r\n        showToast('Usuários sincronizados com sucesso!', INFORMATION);\r\n      },\r\n    });\r\n  };\r\n\r\n  useEffect(\r\n    () => {\r\n      callSincronizacao();\r\n    }, // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    []\r\n  );\r\n\r\n  return (\r\n    <WindowComponent title=\"Manutenção de Usuários\" useGlobalParameter={true} globalParameter={globalReducer.globalParameter} wikiId={1558}>\r\n      {existeUsuarioNaoSincronizado ? (\r\n        <Alert color=\"danger\" className=\"text-center\">\r\n          Atenção!\r\n          <br />\r\n          Por questões de segurança, todos os usuários em vermelho precisam ser atualizados. Para isso, acesse a tela de edição do usuário, ajuste os\r\n          dados, e salve o mesmo.\r\n        </Alert>\r\n      ) : null}\r\n      <SearchDataGrid\r\n        {...props}\r\n        {...props.searchDataGridProps}\r\n        columns={columns}\r\n        dtoClassName={CLASS_NAME}\r\n        cellEditProps={cellEditProps}\r\n        extraData={getExtraData(props, 'UsuarioEditView', CLASS_NAME, { customRemove })}\r\n        ref={searchRef}\r\n        rowClasses={getRowClass}\r\n      />\r\n    </WindowComponent>\r\n  );\r\n};\r\n\r\nexport default UsuarioSearchView;\r\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _objectSpread2 from \"@babel/runtime/helpers/esm/objectSpread\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { mapToCssModules, tagPropType } from './utils';\nimport Fade from './Fade';\nvar propTypes = {\n  children: PropTypes.node,\n  className: PropTypes.string,\n  closeClassName: PropTypes.string,\n  closeAriaLabel: PropTypes.string,\n  cssModule: PropTypes.object,\n  color: PropTypes.string,\n  fade: PropTypes.bool,\n  isOpen: PropTypes.bool,\n  toggle: PropTypes.func,\n  tag: tagPropType,\n  transition: PropTypes.shape(Fade.propTypes),\n  innerRef: PropTypes.oneOfType([PropTypes.object, PropTypes.string, PropTypes.func])\n};\nvar defaultProps = {\n  color: 'success',\n  isOpen: true,\n  tag: 'div',\n  closeAriaLabel: 'Close',\n  fade: true,\n  transition: _objectSpread2({}, Fade.defaultProps, {\n    unmountOnExit: true\n  })\n};\n\nfunction Alert(props) {\n  var className = props.className,\n      closeClassName = props.closeClassName,\n      closeAriaLabel = props.closeAriaLabel,\n      cssModule = props.cssModule,\n      Tag = props.tag,\n      color = props.color,\n      isOpen = props.isOpen,\n      toggle = props.toggle,\n      children = props.children,\n      transition = props.transition,\n      fade = props.fade,\n      innerRef = props.innerRef,\n      attributes = _objectWithoutPropertiesLoose(props, [\"className\", \"closeClassName\", \"closeAriaLabel\", \"cssModule\", \"tag\", \"color\", \"isOpen\", \"toggle\", \"children\", \"transition\", \"fade\", \"innerRef\"]);\n\n  var classes = mapToCssModules(classNames(className, 'alert', \"alert-\" + color, {\n    'alert-dismissible': toggle\n  }), cssModule);\n  var closeClasses = mapToCssModules(classNames('close', closeClassName), cssModule);\n\n  var alertTransition = _objectSpread2({}, Fade.defaultProps, {}, transition, {\n    baseClass: fade ? transition.baseClass : '',\n    timeout: fade ? transition.timeout : 0\n  });\n\n  return React.createElement(Fade, _extends({}, attributes, alertTransition, {\n    tag: Tag,\n    className: classes,\n    in: isOpen,\n    role: \"alert\",\n    innerRef: innerRef\n  }), toggle ? React.createElement(\"button\", {\n    type: \"button\",\n    className: closeClasses,\n    \"aria-label\": closeAriaLabel,\n    onClick: toggle\n  }, React.createElement(\"span\", {\n    \"aria-hidden\": \"true\"\n  }, \"\\xD7\")) : null, children);\n}\n\nAlert.propTypes = propTypes;\nAlert.defaultProps = defaultProps;\nexport default Alert;","import { BasicUser } from 'summer';\r\nimport { Evento } from '../mfp/evento';\r\nimport { Empresa } from './empresa';\r\nimport { EmpresaVW } from './empresaVW';\r\nimport { Perfil } from './perfil';\r\n\r\nexport interface Usuario extends BasicUser {\r\n  login?: string;\r\n  senha?: string;\r\n  hash?: string;\r\n  email?: string;\r\n  empresas?: EmpresaVW[];\r\n  nomeCompleto?: string;\r\n  administrador?: boolean;\r\n  dtInatividade?: string;\r\n  cpf?: string;\r\n  empresaAtual?: Empresa;\r\n  perfil?: Perfil;\r\n  numeroCelular?: string;\r\n  bloquearChat?: boolean;\r\n  funcionario?: boolean;\r\n  cliente?: boolean;\r\n  enviarPorEmail?: boolean;\r\n  envioEmail?: boolean;\r\n  envioSMS?: boolean;\r\n  grauSatisfacao?: string;\r\n  urlLogin?: string;\r\n  diaLimiteLancamento?: number;\r\n  dtSincronizacao?: string;\r\n  eventos?: Evento[];\r\n}\r\n\r\nexport const CLASS_NAME = 'br.com.projetusinformatica.calima.ger.model.dto.usuario';\r\n"],"sourceRoot":""}