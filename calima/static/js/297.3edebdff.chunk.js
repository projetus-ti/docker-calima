(window.webpackJsonp=window.webpackJsonp||[]).push([[297],{1475:function(e,a,t){"use strict";t.r(a);var o=t(100),r=t(6),l=t(13),i=t(14),n=t(0),s=t.n(n),c=t(98),d=t(20),m=t(35),u=t(198),p=t(148),b=t(786),f=t(393),E=t(867),g=t(22),h=t(2),O=t(257),j=t(988),v=t(989);const C={label:"Muito Satisfeito",value:"1"};var P=t(99),S=t(921);var V=e=>s.a.createElement(h.K,Object.assign({},e,{isPrependLabel:!0,inputSearchProps:Object(r.a)(Object(r.a)({},e.inputSearchProps),{},{columns:[{dataField:"descricao",text:"Descri\xe7\xe3o"}],dtoClassName:S.a,searchViewId:"PerfilSearchView"}),label:e.label?e.label:"Perfil",placeholder:e.placeholder?e.placeholder:"Selecione um perfil",type:h.L.INPUT_SEARCH}));const L=[{dataField:"codigo",order:h.O.ASC}];a.default=(e=>{const a=Object(h.Tb)(e),t=Object(n.useState)(void 0),S=Object(l.a)(t,2),y=S[0],x=S[1],M=Object(c.b)({defaultValues:a,mode:"onBlur"}),N=Object(c.b)({mode:"onBlur"}),R=Object(d.c)(e=>e.globalReducer),T=Object(n.useState)(M.getValues().empresas||[]),w=Object(l.a)(T,2),F=w[0],A=w[1],q=Object(n.useState)(M.getValues().eventos||[]),B=Object(l.a)(q,2),I=B[0],K=B[1],k=Object(n.useState)(),D=Object(l.a)(k,2),U=D[0],X=D[1],_=Object(n.useState)(),z=Object(l.a)(_,2),H=z[0],G=z[1],W=Object(n.useState)(),J=Object(l.a)(W,2),Z=J[0],Y=J[1],Q=Object(n.useState)(),$=Object(l.a)(Q,2),ee=$[0],ae=$[1],te=Object(n.useState)(),oe=Object(l.a)(te,2),re=oe[0],le=oe[1],ie=Object(n.useState)(),ne=Object(l.a)(ie,2),se=ne[0],ce=ne[1],de=Object(d.b)(),me=Object(m.g)();Object(n.useEffect)(()=>{const e=M.getValues(),a=e.diaLimiteLancamento,t=e.administrador,o=e.cliente,r=e.funcionario,l=e.perfil,i=e.id,n=e.senha,s=e.grauSatisfacao,c=e.numeroCelular,d=R.globalParameter,m=d.empresa,u=d.acesso;a||(M.getValues().diaLimiteLancamento=1),s||(M.getValues().grauSatisfacao=C.value),c&&(M.getValues().numeroCelular=c.replace("+55","")),M.getValues().senha=fe(n),N.getValues().confirmacaoSenha=fe(N.getValues().confirmacaoSenha),Ee(),x(function(){const e=[],a=R.globalParameter.usuario;if(a.administrador||!a.empresas)return e;const t=a.empresas.map(e=>e.id);return t.length>0&&(e[0].expressions=[{fieldName:"id",operation:"_field in _value",ordered:!0,value:t}]),e}()),Oe(),ue(),be(),M.getValues().empresaAtual=m,G(1===i),l&&l.perfilModulo&&(le(l.perfilModulo.connect||l.perfilModulo.box),M.getValues().enviarPorEmail=void 0===i),o||r||t||(M.getValues().funcionario=!0),ce(u&&u.temCreditoSMS),M.register({name:"empresas"}),M.register({name:"eventos"})},[]);const ue=()=>{const e=M.getValues().perfil;e&&e.perfilModulo?ae(e.perfilModulo.connect&&pe()):ae(!1)},pe=()=>M.getValues().cliente,be=()=>{const e=M.getValues().perfil;e&&e.perfilModulo?Y(!e.perfilModulo.connect&&!e.perfilModulo.box):Y(!0)},fe=e=>{let a=e;return Object(h.Xb)(e)&&M.getValues().dtSincronizacao&&(a="senha_padrao"),a},Ee=(e=!0)=>{const a=M.getValues().perfil,t=R.globalParameter.administradora;if(a&&a.perfilModulo){const o=a.perfilModulo.connect||a.perfilModulo.box;if(le(o),o){M.setValue("enviarPorEmail",Object(h.Xb)(M.getValues().id));const o=t&&!Object(h.Xb)(t.homePage);let l;l=e&&o?t.homePage:a.perfilModulo.connect?"https://connect.projetusti.com.br":a.perfilModulo.site?"https://site.projetusti.com.br":"https://box.projetusti.com.br",M.reset(Object(r.a)(Object(r.a)({},M.getValues()),{},{urlLogin:l}))}}},ge=()=>{le(!1),M.setValue("urlLogin",void 0),M.setValue("enviarPorEmail",!1)},he=(e,a,t)=>()=>{M.setValue(e,M.getValues()[e]),M.setValue(a,!1),M.setValue(t,!1),ue()},Oe=()=>{if(F.length>0){let i=!1;var e,a=Object(o.a)(F);try{for(a.s();!(e=a.n()).done;){const a=e.value;var t,r=Object(o.a)(F);try{for(r.s();!(t=r.n()).done;){const e=t.value;i||a.grupo===e.grupo||(i=!0,X([]),h.ob.emit(h.a.SHOW,{message:"As empresas selecionadas devem pertencer ao mesmo grupo de empresas para que os eventos que foram habilitados sejam enviados ao Connect",type:h.f.INFORMATION}))}}catch(l){r.e(l)}finally{r.f()}}}catch(l){a.e(l)}finally{a.f()}i||Object(P.h)(F[0].id,{errorFunction:e=>{Object(h.sc)(e,h.A)},thenFunction:e=>{X(e)}})}},je=[{dataField:"codigo",editable:!1,filter:{type:h.E.NUMBER},sort:!0,text:"C\xf3digo"},{dataField:"razaoSocial",editable:!1,filter:{type:h.E.TEXT},sort:!0,text:"Raz\xe3o Social"},{dataField:"nomeFantasia",editable:!1,filter:{type:h.E.TEXT},sort:!0,text:"Nome Fantasia"},{dataField:"cnpj",editable:!1,filter:{type:h.E.TEXT},formatter:h.sb,sort:!0,text:"CNPJ"},{dataField:"cpf",editable:!1,filter:{type:h.E.TEXT},formatter:h.ub,sort:!0,text:"CPF"},{dataField:"cei",editable:!1,filter:{type:h.E.TEXT},sort:!0,text:"CEI"},{dataField:"ie",editable:!1,filter:{type:h.E.TEXT},sort:!0,text:"IE"},{dataField:"im",editable:!1,filter:{type:h.E.TEXT},sort:!0,text:"IM"},{dataField:"grupo",editable:!1,filter:{type:h.E.TEXT},sort:!0,text:"Grupo"}],ve={clickToSelect:!0,mode:h.ab.CHECKBOX,onSelect:(e,a)=>{X([]);const t=a?[...F,e]:F.filter(a=>a.id!==e.id);A(t),M.setValue("empresas",t)},onSelectAll:(e,a)=>{X([]),A(e?a:[]),M.setValue("empresas",a)},selected:F.map(e=>e.id)},Ce={clickToSelect:!0,mode:h.ab.CHECKBOX,onSelect:(e,a)=>{const t=a?[...I,e]:I.filter(a=>a.id!==e.id);K(t),M.setValue("eventos",t)},onSelectAll:(e,a)=>{K(e?a:[]),M.setValue("eventos",a)},selected:I.map(e=>e.id)},Pe=e=>({message:e,placement:"top-start"}),Se=()=>{const e=[],a=M.getValues(),t=a.senha,o=a.perfil,r=a.administrador,l=a.funcionario,i=a.cliente;return t!==N.getValues().confirmacaoSenha&&e.push("A senha informada n\xe3o confere com a confirma\xe7\xe3o de senha."),o&&o.perfilModulo&&((o.perfilModulo.box||o.perfilModulo.connect)&&(H||0!==F.length||e.push("Pelo menos 1 empresa deve ser selecionada para usu\xe1rios com perfil que permite acesso ao Calima Connect ou Calima Box."),r||l||i||e.push("\xc9 necess\xe1rio informar o tipo de usu\xe1rio para usu\xe1rios com perfil que permite acesso ao Calima Connect ou Calima Box.")),o.perfilModulo.site&&i&&e.push("Usu\xe1rio do Calima Site n\xe3o pode ser cliente."),o.perfilModulo.box||o.perfilModulo.connect||(M.setValue("envioEmail",!1),M.setValue("envioSMS",!1))),e};return s.a.createElement(h.hb,{title:"Manuten\xe7\xe3o de Usu\xe1rios",useGlobalParameter:!0,globalParameter:R.globalParameter,wikiId:1558},s.a.createElement(h.B,{formProps:M,editViewProps:e,dtoClassName:j.a,validateExtras:Se,externalSubmit:!0},s.a.createElement(h.K,{id:"grauSatisfacao",formProps:M,hidden:!0}),s.a.createElement(h.K,{id:"dtSincronizacao",formProps:M,hidden:!0}),s.a.createElement(h.K,{id:"hash",formProps:M,hidden:!0}),s.a.createElement(h.K,{id:"empresaAtual.id",formProps:M,hidden:!0}),s.a.createElement(h.db,{formProps:M},s.a.createElement(h.cb,{title:"Gerais"},s.a.createElement(u.a,null,s.a.createElement(p.a,null,s.a.createElement(V,{id:"perfil",formProps:Object(r.a)(Object(r.a)({},M),{},{validation:{required:!0}}),disabled:H,onChange:()=>{ge(),Ee(),ue(),be()}}),s.a.createElement(h.K,{id:"nomeCompleto",label:"Nome Completo",formProps:Object(r.a)(Object(r.a)({},M),{},{validation:{required:!0,maxLength:120}}),isPrependLabel:!0,placeholder:"Informe o nome completo"}),s.a.createElement(h.K,{id:"usuario",isPrependLabel:!0,formProps:Object(r.a)(Object(r.a)({},M),{},{validation:{required:!0,maxLength:60}}),label:"Usu\xe1rio",placeholder:"Informe o nome de usu\xe1rio",disabled:H}),s.a.createElement(h.K,{id:"senha",isPrependLabel:!0,formProps:Object(r.a)(Object(r.a)({},M),{},{validation:{required:!0,maxLength:256}}),label:"Senha",placeholder:"Informe a senha",onChange:function(e){"senha_padrao"!==e&&M.setValue("hash",Object(h.cc)(e))},type:h.L.PASSWORD}),s.a.createElement(h.K,{id:"confirmacaoSenha",isPrependLabel:!0,formProps:Object(r.a)(Object(r.a)({},N),{},{validation:{required:!0,maxLength:256}}),label:"Confirma\xe7\xe3o de Senha",placeholder:"Confirme a senha",type:h.L.PASSWORD}),s.a.createElement(h.K,{id:"cpf",isPrependLabel:!0,formProps:Object(r.a)(Object(r.a)({},M),{},{validation:{required:!0}}),label:"CPF",placeholder:"Informe o CPF",type:h.L.CPF}),s.a.createElement(h.K,{id:"email",isPrependLabel:!0,formProps:Object(r.a)(Object(r.a)({},M),{},{validation:{required:!0,maxLength:120}}),label:"E-mail",placeholder:"Informe o e-mail",type:h.L.EMAIL,tooltipProps:{message:"E-mail para envio de notifica\xe7\xf5es"}}),s.a.createElement(h.K,{id:"numeroCelular",isPrependLabel:!0,formProps:Object(r.a)(Object(r.a)({},M),{},{validation:{required:M.getValues().envioSMS}}),label:"Celular",type:h.L.TELEFONE,tooltipProps:{message:"Celular para envio de notifica\xe7\xf5es via SMS"}}),s.a.createElement(h.K,{id:"dtInatividade",isPrependLabel:!0,formProps:M,label:"Data de Inatividade",placeholder:"Informe a data de inatividade",type:h.L.DATE,disabled:H}),s.a.createElement(b.a,{id:"idbloquearChat",name:"bloquearChat",label:"Bloquear Chat para o Usu\xe1rio",type:"switch",innerRef:M.register,disabled:H}),Object(h.wc)(Pe("Bloqueia o uso do chat para o usu\xe1rio. Op\xe7\xe3o dispon\xedvel apenas para o n\xedvel de acesso administrador."),"bloquearChat"),s.a.createElement("br",null),s.a.createElement(f.a,{style:{marginRight:20}},"Tipo de Usu\xe1rio"),s.a.createElement(b.a,{id:"administrador",inline:!0,innerRef:M.register,label:"Administrador",name:"administrador",type:"switch",disabled:H,onChange:he("administrador","funcionario","cliente")}),s.a.createElement(b.a,{id:"funcionario",inline:!0,innerRef:M.register,label:"Funcion\xe1rio",name:"funcionario",type:"switch",disabled:H,onChange:he("funcionario","administrador","cliente")}),s.a.createElement(b.a,{id:"cliente",inline:!0,innerRef:M.register,label:"Cliente",name:"cliente",type:"switch",disabled:H,onChange:he("cliente","funcionario","administrador")})))),s.a.createElement(h.cb,{title:"Empresas",disabled:H},s.a.createElement(E.a,{color:"primary",className:"text-center"},"Caso seja marcada alguma empresa, o controle de empresa por usu\xe1rio ser\xe1 ativado. Uma vez ativo, para cada empresa nova criada deve-se configurar o acesso ao usu\xe1rio para a mesma manualmente."),s.a.createElement(h.Z,Object.assign({},e,e.searchDataGridProps,{columns:je,selectRow:ve,defaultSorted:L,dtoClassName:O.a,extraData:Object(r.a)(Object(r.a)({},Object(h.Sb)(e,"EmpresaEditView",O.a)),{},{hideActionColumn:!0}),searchExpressionsProps:y,remote:{cellEdit:!1,filter:!1,pagination:!1,search:!1,sort:!1},addButtonProps:{hideAddButton:!0}}))),s.a.createElement(h.cb,{title:"Configura\xe7\xf5es do Box e Connect",disabled:Z},s.a.createElement(u.a,null,s.a.createElement(p.a,null,se?null:s.a.createElement(E.a,{color:"primary",className:"text-center"},s.a.createElement("a",{id:"linkLoja",href:"https://atendimento.projetusti.com.br/chat/#/0f01ea6c-dbd3-42f4-9543-c951702ab3de/",className:"btn-link",target:"_blank",rel:"noopener noreferrer"},"O servi\xe7o Notifica\xe7\xf5es via SMS n\xe3o est\xe1 habilitado. Clique aqui para adquiri-lo!")))),s.a.createElement(u.a,null,s.a.createElement(p.a,null,s.a.createElement(b.a,{type:"switch",label:"Deseja receber notifica\xe7\xf5es no email cadastrado?",name:"envioEmail",id:"idenvioEmail",innerRef:M.register}),Object(h.wc)(Pe("Permite que o Calima envie e-mails de notifica\xe7\xe3o."),"envioEmail"))),s.a.createElement(u.a,null,s.a.createElement(p.a,null,s.a.createElement(b.a,{type:"switch",label:"Deseja receber notifica\xe7\xf5es por sms no celular cadastrado?",name:"envioSMS",id:"idenvioSMS",disabled:!se,innerRef:M.register}),Object(h.wc)(Pe("Permite que o Calima envie SMS de notifica\xe7\xe3o."),"envioSMS"))),re?s.a.createElement(u.a,null,s.a.createElement(p.a,null,s.a.createElement(b.a,{type:"switch",label:"Deseja enviar credenciais por e-mail ao salvar usu\xe1rio?",name:"enviarPorEmail",id:"idenviarPorEmail",innerRef:M.register}),Object(h.wc)(Pe("Envia um email para o usu\xe1rio com o login, senha e URL de acesso ao Calima Connect ao salvar o usu\xe1rio"),"enviarPorEmail"))):null,s.a.createElement(u.a,null,s.a.createElement(p.a,null,s.a.createElement(h.K,{formProps:M,id:"diaLimiteLancamento",isPrependLabel:!0,label:"Dia Limite para Lan\xe7amentos no Calima Connect",type:h.L.NUMBER}))),re?s.a.createElement(u.a,null,s.a.createElement(p.a,null,s.a.createElement(h.K,{formProps:M,id:"urlLogin",isPrependLabel:!0,label:"URL de acesso ao Connect ou Box",type:h.L.URL})),s.a.createElement(p.a,{className:"col-2"},s.a.createElement(g.a,{id:"idrestaurarPadrao",size:"lg",color:"link",className:"text-success",onClick:()=>{Ee(!1),M.getValues().enviarPorEmail=!0}},s.a.createElement(i.a,{icon:"reply"})),Object(h.wc)(Pe("Restaurar a URL de acesso de acordo com o perfil do usu\xe1rio"),"restaurarPadrao"))):null),s.a.createElement(h.cb,{title:"Eventos Habilitados no Connect",disabled:!ee},s.a.createElement(E.a,{color:"primary",className:"text-center"},"Caso seja marcado algum evento, o mesmo ser\xe1 habilitado para o Connect."),s.a.createElement(g.a,{onClick:Oe,color:"primary",className:"mb-2 mr-2"},s.a.createElement(i.a,{icon:"sync"})," Consultar Eventos"),s.a.createElement(h.Z,{data:U,columns:[{dataField:"codigo",editable:!1,sort:!0,text:"C\xf3digo"},{dataField:"descricao",editable:!1,sort:!0,text:"Descri\xe7\xe3o"},{dataField:"tipo",editable:!1,sort:!0,text:"Tipo"}],selectRow:Ce,dtoClassName:v.a,extraData:Object(r.a)(Object(r.a)({},Object(h.Sb)(e,"EventoEditView",v.a)),{},{hideActionColumn:!0,hideCustomSearch:!0}),addButtonProps:{hideAddButton:!0}}))),s.a.createElement(h.R,{handleSubmit:()=>{M.setValue("empresas",F),M.setValue("eventos",I);const e=Se();if(e.length>0){const a={message:s.a.createElement(h.C,{erros:e}),type:h.f.ERROR};h.ob.emit(h.a.SHOW,a)}else{const e=M.getValues(),a=e.senha,t=e.numeroCelular;"senha_padrao"===a&&M.setValue("senha",""),t&&M.setValue("numeroCelular","+55"+M.getValues().numeroCelular),de(h.mc.showProgress({animated:!0,className:"progress-bar-rounded progress-animated-alt",color:"first",label:"Aguarde, processando...",striped:!0,value:100})),Object(P.m)(M.getValues(),{errorFunction:e=>{de(h.mc.hideProgress()),Object(h.sc)(e,h.A)},thenFunction:e=>{e&&(de(h.mc.hideProgress()),Object(h.sc)("A\xe7\xe3o conclu\xedda com sucesso!",h.Y),me.goBack())}})}},btnSubmitIcon:"save",btnSubmitLabel:"Salvar",handleClose:()=>{me.goBack()}})))})},867:function(e,a,t){"use strict";var o=t(3),r=t(9),l=t(19),i=t(0),n=t.n(i),s=t(1),c=t.n(s),d=t(8),m=t.n(d),u=t(5),p=t(56),b={children:c.a.node,className:c.a.string,closeClassName:c.a.string,closeAriaLabel:c.a.string,cssModule:c.a.object,color:c.a.string,fade:c.a.bool,isOpen:c.a.bool,toggle:c.a.func,tag:u.q,transition:c.a.shape(p.a.propTypes),innerRef:c.a.oneOfType([c.a.object,c.a.string,c.a.func])},f={color:"success",isOpen:!0,tag:"div",closeAriaLabel:"Close",fade:!0,transition:Object(l.a)({},p.a.defaultProps,{unmountOnExit:!0})};function E(e){var a=e.className,t=e.closeClassName,i=e.closeAriaLabel,s=e.cssModule,c=e.tag,d=e.color,b=e.isOpen,f=e.toggle,E=e.children,g=e.transition,h=e.fade,O=e.innerRef,j=Object(r.a)(e,["className","closeClassName","closeAriaLabel","cssModule","tag","color","isOpen","toggle","children","transition","fade","innerRef"]),v=Object(u.m)(m()(a,"alert","alert-"+d,{"alert-dismissible":f}),s),C=Object(u.m)(m()("close",t),s),P=Object(l.a)({},p.a.defaultProps,{},g,{baseClass:h?g.baseClass:"",timeout:h?g.timeout:0});return n.a.createElement(p.a,Object(o.a)({},j,P,{tag:c,className:v,in:b,role:"alert",innerRef:O}),f?n.a.createElement("button",{type:"button",className:C,"aria-label":i,onClick:f},n.a.createElement("span",{"aria-hidden":"true"},"\xd7")):null,E)}E.propTypes=b,E.defaultProps=f,a.a=E},921:function(e,a,t){"use strict";t.d(a,"a",function(){return o});const o="br.com.projetusinformatica.calima.ger.model.dto.perfil"},988:function(e,a,t){"use strict";t.d(a,"a",function(){return o});const o="br.com.projetusinformatica.calima.ger.model.dto.usuario"},989:function(e,a,t){"use strict";t.d(a,"a",function(){return o});const o="br.com.projetusinformatica.calima.mfp.model.dto.evento"}}]);
//# sourceMappingURL=297.3edebdff.chunk.js.map