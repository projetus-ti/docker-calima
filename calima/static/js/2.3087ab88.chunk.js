(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1004:function(e,a,t){"use strict";t.d(a,"b",function(){return o}),t.d(a,"c",function(){return n}),t.d(a,"a",function(){return r});const o={label:"Lan\xe7amento \xdanico",value:0},n={label:"V\xe1rios Lan\xe7amentos",value:1},r=[o,n]},1005:function(e,a,t){"use strict";t.d(a,"c",function(){return o}),t.d(a,"d",function(){return n}),t.d(a,"b",function(){return r}),t.d(a,"e",function(){return i}),t.d(a,"a",function(){return l});const o={label:"Um D\xe9bito Para Um Cr\xe9dito",value:0},n={label:"Um D\xe9bito Para V\xe1rios cr\xe9ditos",value:1},r={label:"Um Cr\xe9dito Para V\xe1rios D\xe9bitos",value:2},i={label:"V\xe1rios D\xe9bitos Para V\xe1rios Cr\xe9ditos",value:4},l=[o,n,r,i]},1006:function(e,a,t){"use strict";t.d(a,"c",function(){return o}),t.d(a,"b",function(){return n}),t.d(a,"a",function(){return r});const o={label:"Sim",value:"S"},n={label:"N\xe3o",value:"N"},r=[o,n,{label:"Apenas Avisar",value:"A"}]},1007:function(e,a,t){"use strict";var o=t(6),n=t(0),r=t.n(n),i=t(2),l=t(888);a.a=(e=>r.a.createElement(i.K,Object.assign({},e,{formProps:Object(o.a)({},e.formProps),isPrependLabel:!0,inputSearchProps:Object(o.a)(Object(o.a)({},e.inputSearchProps),{},{columns:[{dataField:"descricao",text:"Descri\xe7ao"}],dtoClassName:l.a,searchViewId:"LancamentoMCGConfigSearchView"}),label:e.label?e.label:"Configura\xe7\xe3o Padr\xe3o de Lan\xe7amento",placeholder:e.placeholder?e.placeholder:"Informe a Configura\xe7\xe3o Padr\xe3o de Lan\xe7amento",type:i.L.INPUT_SEARCH})))},1116:function(e,a,t){"use strict";t.r(a);var o=t(6),n=t(13),r=t(14),i=t(25),l=t(0),c=t.n(l),s=t(98),d=t(20),m=t(44),u=t(198),b=t(148),C=t(46),p=t(22),f=t(126),E=t(196),O=t(197),g=t(2);const h="br.com.projetusinformatica.calima.mcg.model.dto.lancamentolote";var v=t(895),P=t(981);const L={value:"NAO_INTERFERE",label:"N\xe3o Interfere no Patrim\xf4nio L\xedquido",extraFields:{intValue:0}},j=[L,{value:"LUCRO_LIQUIDO_EXERCICIO",label:"Lucro L\xedquido do Exerc\xedcio",extraFields:{intValue:1}},{extraFields:{intValue:2},label:"Preju\xedzo L\xedquido do Exerc\xedcio",value:"PREJUIZO_LIQUIDO_EXERCICIO"},{value:"REDUCAO_DIVIDENDOS",label:"Redu\xe7\xe3o por Dividendos",extraFields:{intValue:3}},{extraFields:{intValue:4},label:"Acr\xe9scimo por Reavalia\xe7\xe3o de Ativos",value:"ACRESCIMO_REAVALIACAO_ATIVO"},{extraFields:{intValue:5},label:"Acr\xe9scimo por Doa\xe7\xf5es e Subven\xe7\xf5es para Investimentos Recebidos",value:"ACRESC_DOACAO_SUBVENCAO_INVEST"},{extraFields:{intValue:6},label:"Acr\xe9scimo por Subscri\xe7\xe3o e Integraliza\xe7\xe3o de Capital",value:"SUBSC_INTEGRALIZACAO_CAPITAL"},{extraFields:{intValue:7},label:"Acr\xe9scimo pelo Recebimento de Valor que Exceda o Valor Nominal das A\xe7\xf5es \n Integralizadas ou o  Pre\xe7o de Emiss\xe3o das A\xe7\xf5es sem Valor Nominal",value:"ACRESCIMO_EXCEDA_VALOR_NOMINAL"},{extraFields:{intValue:8},label:"Acr\xe9scimo pelo Valor da Aliena\xe7\xe3o de Partes Benefici\xe1rias e B\xf4nus de Subscri\xe7\xe3o",value:"ACRESCIMO_VALOR_ALIENACAO"},{extraFields:{intValue:9},label:"Acr\xe9scimo por Pr\xeamio Recebido na Emiss\xe3o de Deb\xeantures",value:"ACRESCIMO_PREMIO_RECEBIDO"},{extraFields:{intValue:10},label:"Redu\xe7\xe3o por A\xe7\xf5es Pr\xf3prias Adquiridas ou Acr\xe9scimo por sua Venda",value:"REDUC_ACOES_OU_ACRESC_POR_VENDA"},{extraFields:{intValue:11},label:"Acr\xe9scimo ou Redu\xe7\xe3o por Ajuste de Exerc\xedcios Anteriores",value:"ACRESC_OU_REDUCAO_EXERCICIO_ANT"}];var A=t(1004),D=t(1005),x=t(1006),V=t(982),R=t(938),N=t(830),I=t(865),S=t(914),H=t(859),F=t(900),w=t(1007),k=t(940);var y=e=>c.a.createElement(g.K,Object.assign({},e,{isPrependLabel:!0,inputSearchProps:Object(o.a)(Object(o.a)({},e.inputSearchProps),{},{columns:[{dataField:"codigo",text:"C\xf3digo"},{dataField:"descricao",text:"Descri\xe7\xe3o"}],dtoClassName:k.a,searchViewId:"LancamentoPadraoSearchView"}),label:e.label,placeholder:e.placeholder,type:g.L.INPUT_SEARCH})),_=t(835),M=t(201),z=t.n(M),T=t(202),X=t.n(T);t(396),t(397),t(1131);var G=e=>{const a=Object(l.useState)(null),t=Object(n.a)(a,2),i=t[0],s=t[1],d=e.formProps.watch("historicos").map((e,a)=>Object(o.a)(Object(o.a)({},e),{},{rowIndex:a})),u=(e,a,t)=>s(Object(o.a)(Object(o.a)({},e),{},{rowIndex:t+1})),b=()=>{const e=null!==i;return!1===e&&g.ob.emit(g.a.SHOW,{message:"Selecione um registro",type:g.f.INFORMATION}),e},C=()=>{b()&&e.onEdit(i)},h=a=>()=>{if(b()){const t=i.rowIndex-1,n=t+a;d.splice(t,1),d.splice(n,0,i),s(Object(o.a)(Object(o.a)({},i),{},{rowIndex:n+1})),e.formProps.setValue("historicos",[...d])}};return c.a.createElement(f.a,{className:"card-box grid-historicos"},c.a.createElement(E.a,{className:"card-header pr-2"},c.a.createElement("div",{className:"card-header--title"},"Hist\xf3ricos"),c.a.createElement("div",{className:"card-header--actions"},c.a.createElement(p.a,{id:"moveUpButton",size:"sm",color:"link",className:"text-success",onClick:h(-1)},c.a.createElement(r.a,{icon:"long-arrow-alt-up"})),c.a.createElement(m.a,{target:"moveUpButton"},"Mover - Acima"),c.a.createElement(p.a,{id:"moveDownButton",size:"sm",color:"link",className:"text-success",onClick:h(1)},c.a.createElement(r.a,{icon:"long-arrow-alt-down"})),c.a.createElement(m.a,{target:"moveDownButton"},"Mover - Abaixo"),c.a.createElement(p.a,{id:"editHistButton",size:"sm",color:"link",className:"text-warning",onClick:C,disabled:e.disabled},c.a.createElement(r.a,{icon:"pen"})),c.a.createElement(m.a,{target:"editHistButton"},"Editar Hist\xf3rico Selecionado"),c.a.createElement(p.a,{id:"removeHistButton",size:"sm",color:"link",className:"text-danger",onClick:()=>{b()&&e.onRemove(i)},disabled:e.disabled},c.a.createElement(r.a,{icon:"trash"})),c.a.createElement(m.a,{target:"removeHistButton"},"Excluir Hist\xf3rico Selecionado"))),c.a.createElement(O.a,null,c.a.createElement(X.a,{keyField:"rowIndex",columns:[{dataField:"historico.codigo",text:"C\xf3digo"},{dataField:"historico.descricao",text:"Descri\xe7\xe3o"},{dataField:"historicoVariavel",text:"Hist\xf3rico Vari\xe1vel"}],data:d,bootstrap4:!0},e=>[c.a.createElement(z.a,Object.assign({},e.baseProps,{striped:!0,bordered:!0,hover:!0,responsive:!0,condensed:!0,key:"histVariavelDados",selectRow:{clickToSelect:!0,mode:"radio",onSelect:u,selected:i?[i.rowIndex-1]:[]},rowEvents:{onDoubleClick:()=>C()}})),c.a.createElement("div",{key:"divFotterKey",className:"text-left"},"Registros: ",d.length)])))},B=t(941),W=t(902);t(1132);var q=e=>{const a=Object(l.useState)(null),t=Object(n.a)(a,2),i=t[0],s=t[1],d=[{dataField:"data",text:"Data do Lan\xe7amento"},{dataField:"lote",formatter:()=>e.numeroLote,text:"N\xba Lote"},{dataField:"numero",text:"N\xba Lan\xe7amento"},{dataField:"contaDebitoOuCR",formatter:(a,t)=>{let o="";return t.planoContaDebito&&(o=e.empresaMCG.tipoLancamentoConta===W.a.value?t.planoContaDebito.codigoReduzido:t.planoContaDebito.conta),o},text:"Conta de D\xe9bito"},{dataField:"centroCustoDebitoOuCR",formatter:(a,t)=>{let o="";return t.centroCustoDebito&&(o=e.empresaMCG.tipoLancamentoConta===B.b.value?t.centroCustoDebito.codigoReduzido:t.centroCustoDebito.codigo),o},hidden:!e.lancamentoConfig||!1===e.lancamentoConfig.utilizarCentroCusto,text:"Centro de Custo D\xe9bito"},{dataField:"contaCreditoOuCR",formatter:(a,t)=>{let o="";return t.planoContaCredito&&(o=e.empresaMCG.tipoLancamentoConta===W.a.value?t.planoContaCredito.codigoReduzido:t.planoContaCredito.conta),o},text:"Conta de Cr\xe9dito"},{dataField:"centroCustoCreditoOuCR",formatter:(a,t)=>{let o="";return t.centroCustoCredito&&(o=e.empresaMCG.tipoLancamentoConta===B.b.value?t.centroCustoCredito.codigoReduzido:t.centroCustoCredito.codigo),o},hidden:!e.lancamentoConfig||!1===e.lancamentoConfig.utilizarCentroCusto,text:"Centro de Custo Cr\xe9dito"},{dataField:"valor",formatter:g.zb,text:"Valor"},{dataField:"historicos",formatter:S.a,text:"Hist\xf3rico"}],u={credito:0,debito:0,diferenca:0},b=e.formProps.watch("lancamentos").map((e,a)=>Object(o.a)(Object(o.a)({},e),{},{rowIndex:a}));b.forEach(e=>{e.planoContaCredito&&(u.credito+=e.valor),e.planoContaDebito&&(u.debito+=e.valor)});const C=(e,a,t)=>s(Object(o.a)(Object(o.a)({},e),{},{rowIndex:t+1})),h=()=>{const e=null!==i;return!1===e&&g.ob.emit(g.a.SHOW,{message:"Selecione um registro",type:g.f.INFORMATION}),e},v=()=>{h()&&e.onEdit(i)};return c.a.createElement(f.a,{className:"card-box grid-lancamentos"},c.a.createElement(E.a,{className:"card-header pr-2"},c.a.createElement("div",{className:"card-header--title"},"Lan\xe7amentos"),c.a.createElement("div",{className:"card-header--actions"},c.a.createElement(p.a,{id:"editLancButton",size:"sm",color:"link",className:"text-warning",onClick:v,disabled:e.disabled},c.a.createElement(r.a,{icon:"pen"})),c.a.createElement(m.a,{target:"editLancButton"},"Editar Lan\xe7amento Selecionado"),c.a.createElement(p.a,{id:"removeLancButton",size:"sm",color:"link",className:"text-danger",onClick:()=>{h()&&e.onRemove(i)},disabled:e.disabled},c.a.createElement(r.a,{icon:"trash"})),c.a.createElement(m.a,{target:"removeLancButton"},"Excluir Lan\xe7amento Selecionado"))),c.a.createElement(O.a,null,c.a.createElement(X.a,{keyField:"rowIndex",columns:d,data:b,bootstrap4:!0},e=>[c.a.createElement(z.a,Object.assign({},e.baseProps,{striped:!0,bordered:!0,hover:!0,responsive:!0,condensed:!0,key:"histVariavelDados",selectRow:{clickToSelect:!0,mode:"radio",onSelect:C},rowEvents:{onDoubleClick:()=>v()}})),c.a.createElement("div",{key:"divFotterKey",className:"d-flex justify-content-between"},c.a.createElement("span",null,"Registros: ",b.length),c.a.createElement("div",{className:"footer"},c.a.createElement("span",null,"D\xe9bito: ",Object(g.zb)(u.debito,null)),c.a.createElement("span",null,"Cr\xe9dito: ",Object(g.zb)(u.credito,null)),c.a.createElement("span",null,"Diferen\xe7a: ",Object(g.zb)(u.credito-u.credito,null))))])))},K=t(97),U=t(255),Y=t(808),J=t(147),Q=t(392);var Z=e=>{const a=Object(s.b)({defaultValues:{dtLancamento:e.dataLancamento},mode:"onBlur"}),t=Object(l.useState)([]),r=Object(n.a)(t,2),i=r[0],d=r[1],m=Object(l.useState)(-1),C=Object(n.a)(m,2),p=C[0],f=C[1];Object(l.useEffect)(()=>{setTimeout(()=>{O(0)},700)},[]),Object(l.useEffect)(()=>{const a=p+1;a<e.lotePadrao.lotePadraoLancamento.length?O(a):(e.onConfirm(i),e.onClose())},[i]);const E=a=>{let t="";const o=e.globalParameter.empresaMCG.tipoLancamentoConta===W.a.value;return a&&(t=o?a.codigoReduzido:a.conta),t},O=t=>{f(t);const o=e.lotePadrao.lotePadraoLancamento[t];a.setValue([{debito:E(o.planoContaDebito)},{credito:E(o.planoContaCredito)},{centroCustoDebito:o.centroCustoDebito&&o.centroCustoDebito.descricao},{centroCustoCredito:o.centroCustoCredito&&o.centroCustoCredito.descricao},{historico:Object(S.a)(o.historico)},{valor:null}])};return c.a.createElement(K.a,{isOpen:!0,backdrop:"static",centered:!0,toggle:e.onClose,size:"lg"},c.a.createElement(U.a,{toggle:e.onClose},c.a.createElement(Y.a,{color:"primary",pill:!0,className:"mr-2 mt-1 align-top"},p+1," / ",e.lotePadrao.lotePadraoLancamento.length),"Lan\xe7amento Padr\xe3o"),c.a.createElement(J.a,null,c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:Object(o.a)(Object(o.a)({},a),{},{validation:{required:!0}}),isPrependLabel:!0,id:"dtLancamento",label:"Data",type:g.L.DATE}))),c.a.createElement(g.g,{title:"D\xe9bito"},c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:a,isPrependLabel:!0,id:"debito",label:"Conta",disabled:!0}))),e.lancamentoConfig.utilizarCentroCusto&&c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:a,isPrependLabel:!0,id:"centroCustoDebito",label:"Centro Custo",disabled:!0})))),c.a.createElement(g.g,{title:"Cr\xe9dito"},c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:a,isPrependLabel:!0,id:"credito",label:"Conta",disabled:!0}))),e.lancamentoConfig.utilizarCentroCusto&&c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:a,isPrependLabel:!0,id:"centroCustoCredito",label:"Centro Custo",disabled:!0})))),c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:a,isPrependLabel:!0,id:"historico",label:"Hist\xf3rico",type:g.L.TEXT_AREA,disabled:!0}))),c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:a,isPrependLabel:!0,id:"valor",label:"Valor",type:g.L.MONEY})))),c.a.createElement(Q.a,null,c.a.createElement(g.R,{handleSubmit:a.handleSubmit(()=>{const t=a.getValues(),o=(e=>{const a=[];Object(g.Xb)(e.dtLancamento)&&a.push("Data de Lan\xe7amento: Campo n\xe3o pode estar em branco");const t=parseFloat(e.valor);return(isNaN(t)||t<=0)&&a.push("Valor: Valor deve ser maior que 0"),a})(t);if(o.length>0)g.ob.emit(g.a.SHOW,{message:c.a.createElement(g.C,{erros:o}),type:g.f.ERROR});else{const a=e.lotePadrao.lotePadraoLancamento[p];d(e=>[...e,{centroCustoCredito:a.centroCustoCredito,centroCustoDebito:a.centroCustoDebito,data:t.dtLancamento,historicos:a.historico.map(e=>({codigo:e.historico?e.historico.codigo:null,descricao:e.historico?e.historico.descricao:null,historico:e.historico||null,historicoVariavel:e.historicoVariavel})),planoContaCredito:a.planoContaCredito,planoContaDebito:a.planoContaDebito,valor:t.valor}])}}),handleClose:()=>{i.length>0&&e.onConfirm(i),e.onClose()}})))};t(1133);a.default=(e=>{const a=Object(d.c)(e=>e.globalReducer),t=Object(g.Tb)(e),k=Object(s.b)({defaultValues:{historicos:[],lancamentos:[],somaCredito:"0,00",somaDebito:"0,00"},mode:"onBlur"}),M=Object(l.useState)(a.globalParameter.lancamentoMCGConfig),z=Object(n.a)(M,2),T=z[0],X=z[1],B=Object(l.useState)(null),W=Object(n.a)(B,2),K=W[0],U=W[1],Y=Object(l.useState)(!1),J=Object(n.a)(Y,2),Q=J[0],$=J[1],ee=Object(l.useState)(null),ae=Object(n.a)(ee,2),te=ae[0],oe=ae[1],ne=Object(l.useState)(null),re=Object(n.a)(ne,2),ie=re[0],le=re[1],ce=Object(l.useState)(!1),se=Object(n.a)(ce,2),de=se[0],me=se[1],ue=Object(l.useState)(!1),be=Object(n.a)(ue,2),Ce=be[0],pe=be[1],fe=Object(l.useState)(null),Ee=Object(n.a)(fe,2),Oe=Ee[0],ge=Ee[1],he=Object(l.useState)(!1),ve=Object(n.a)(he,2),Pe=ve[0],Le=ve[1],je=Object(l.useState)({fixarCentroCustoCredito:!1,fixarCentroCustoDebito:!1,fixarContaCredito:!1,fixarContaDebito:!1,fixarData:!1,fixarHistoricoPadrao:!1,fixarHistoricoVariavel:!1}),Ae=Object(n.a)(je,2),De=Ae[0],xe=Ae[1],Ve=Object(l.useState)({centroCustoCredito:!0,centroCustoDebito:!0}),Re=Object(n.a)(Ve,2),Ne=Re[0],Ie=Re[1];Object(l.useEffect)(()=>{["historicos","lancamentos","idLancamentoAtual","idHistoricoAtual","indexLancamentoAtual","indexHistoricoAtual"].forEach(e=>k.register({name:e})),setTimeout(()=>{const e=Object(g.pc)(a.globalParameter.empresaMCG.refAtual),n=Object(g.pc)(a.globalParameter.empresaMCG.refFinal);k.setValue("configuracao",Object(o.a)(Object(o.a)({},T),{},{label:T.descricao})),k.setValue("formaLancamento",T.formaLancamento),k.setValue("referencia","".concat(e," \xe0 ").concat(n)),ye(),t&&!Object(g.Xb)(t.idLote)&&Se()},700)},[]),Object(l.useEffect)(()=>{xe(Object.keys(De).map(e=>({[e]:De[e]&&T[e]})).reduce((e,a)=>Object(o.a)(Object(o.a)({},e),a)))},[T]),Object(l.useEffect)(()=>{e.isFromVerifyError&&!Object(g.Xb)(e.idMcgLancamentoLote)&&(t.idLote=e.idMcgLancamentoLote,Se())},[]);const Se=()=>{Object(g.Kb)({id:t.idLote},h,{thenFunction:e=>{ge(e),k.setValue([{lancamentos:e.lancamentos},{numero:e.numero}]),e.dataInclusao&&e.horaInclusao&&le("".concat(e.dataInclusao," ").concat(e.horaInclusao));const a=k.getValues();if(e.lancamentos.length>1&&a.formaLancamento===D.c.value){const e=D.e.value;k.setValue("formaLancamento",e),X(Object(o.a)(Object(o.a)({},T),{},{formaLancamento:e}))}He()}})},He=()=>{const e=k.getValues();e.lancamentos.length>0&&Fe(e.lancamentos[e.lancamentos.length-1])},Fe=e=>{me(!0),k.setValue([{indexLancamentoAtual:e.rowIndex||null},{idLancamentoAtual:e.id},{planoContaCredito:e.planoContaCredito},{planoContaDebito:e.planoContaDebito},{numeroLancamento:e.numero},{centroCustoCredito:e.centroCustoCredito},{centroCustoDebito:e.centroCustoDebito},{data:e.data},{efeitoPatrimonioLiquido:e.efeitoPatrimonioLiquido},{historicos:e.historicos},{encerrado:e.encerrado},{valor:e.valor}]),we(e),ye(!1),Le(!T.informarLancamentoEncerramento&&e.encerrado),setTimeout(()=>{Be(e.planoContaCredito),Ge(e.planoContaDebito)},200)},we=e=>{e.historicos.length>0&&ke(Object(o.a)(Object(o.a)({},e.historicos[e.historicos.length-1]),{},{rowIndex:e.historicos.length}))},ke=e=>{pe(!0),k.setValue([{idHistoricoAtual:e.id},{indexHistoricoAtual:e.rowIndex||null},{historicoAtual:e.historico},{historicoVariavel:e.historicoVariavel}])},ye=(e=!0)=>{const t=k.getValues();U(t.data?Object(S.b)(t.data,a.globalParameter):P.c.label),e&&(Me(),ze())},_e=()=>{let e=!1;const t=a.globalParameter.grupoPlanoConta.digitoPatrimonioLiquido;if(t){const a=k.getValues();a.planoContaDebito&&(e=a.planoContaDebito.conta.substr(0,t.length)===t),!e&&a.planoContaCredito&&(e=a.planoContaCredito.conta.substr(0,t.length)===t)}$(e)},Me=(e=null,t=!1)=>{_e();const o=k.getValues();k.setValue("somaDebito",Object(g.Ob)(0)),o.planoContaDebito&&o.data&&Object(N.B)({conta:e?e.conta:o.planoContaDebito.conta,data:o.data,idGerEmpresa:a.globalParameter.empresa.id},{thenFunction:e=>{k.setValue("somaDebito",Object(g.Ob)(e)),t&&g.ob.emit(g.a.SHOW,{message:"Saldo D\xe9bito: "+Object(g.Ob)(e),type:g.f.INFORMATION})}})},ze=(e=null,t=!1)=>{_e();const o=k.getValues();k.setValue("somaCredito",Object(g.Ob)(0)),o.planoContaCredito&&o.data&&Object(N.A)({conta:e?e.conta:o.planoContaCredito.conta,data:o.data,idGerEmpresa:a.globalParameter.empresa.id},{thenFunction:e=>{k.setValue("somaCredito",Object(g.Ob)(e)),t&&g.ob.emit(g.a.SHOW,{message:"Saldo Cr\xe9dito: "+Object(g.Ob)(e),type:g.f.INFORMATION})}})},Te=(e,t)=>{const n=e&&e.conta.substr(0,1)!==a.globalParameter.grupoPlanoConta.digitoAtivo&&e.conta.substr(0,1)!==a.globalParameter.grupoPlanoConta.digitoPassivo,r=T&&T.utilizarCentroCustoAtivoPassivo;e&&(r||n)?Ie(e=>Object(o.a)(Object(o.a)({},e),{},{[t]:!1})):(k.setValue(t,null),Ie(e=>Object(o.a)(Object(o.a)({},e),{},{[t]:!0})))},Xe=(e,t)=>{let o=null;e&&("planoContaDebito"===t?e.conta&&e.conta.charAt(0)===a.globalParameter.grupoPlanoConta.digitoReceita&&(o="Deseja realmente informar uma Conta de Receita para D\xe9bito?"):"planoContaCredito"===t&&e.conta&&e.conta.charAt(0)===a.globalParameter.grupoPlanoConta.digitoDespesa&&(o="Deseja realmente informar uma Conta de Despesa para Cr\xe9dito?")),o&&g.ob.emit(g.a.SHOW,{message:o,onNoClick:()=>k.setValue(t,null),type:g.f.WARNING_YES_NO})},Ge=e=>{Me(e),Te(e,"centroCustoDebito"),T&&T.validarLancReceitaDespesa&&Xe(e,"planoContaDebito")},Be=e=>{ze(e),Te(e,"centroCustoCredito"),T&&T.validarLancReceitaDespesa&&Xe(e,"planoContaCredito")},We=()=>oe(null),qe=e=>{const a=[...k.getValues().lancamentos,...e];k.setValue("lancamentos",a.map((e,a)=>Object(o.a)(Object(o.a)({},e),{},{rowIndex:a+1}))),(e=>{let a=0,t=0,n=0;e.forEach(e=>{e.planoContaCredito&&a++,e.planoContaDebito&&t++,e.historicos.length>1&&n++});const r=Object(o.a)({},T);r.historico=n>0?A.c.value:A.b.value,a>0&&t>0&&(1===a&&1===t&&1===e.length?r.formaLancamento=D.c.value:r.formaLancamento=1===a&&t>1?D.b.value:1===t&&a>1?D.d.value:D.e.value),X(r),k.setValue("formaLancamento",r.formaLancamento)})(a),He()},Ke=()=>{const e=k.getValues();if(!Object(g.Xb)(e.historicoAtual)||!Object(g.Xb)(e.historicoVariavel)){const a={codigo:e.historicoAtual?e.historicoAtual.codigo:null,descricao:e.historicoAtual?e.historicoAtual.descricao:null,historico:e.historicoAtual,historicoVariavel:e.historicoVariavel};e.idHistoricoAtual||e.indexHistoricoAtual?k.setValue("historicos",e.historicos.map((t,n)=>{let r=t;const i=e.idHistoricoAtual&&e.idHistoricoAtual===t.id,l=e.indexHistoricoAtual&&e.indexHistoricoAtual-1===n;return(i||l)&&(r=Object(o.a)(Object(o.a)({},t),a)),r})):k.setValue("historicos",[...e.historicos,a]),pe(!1),k.setValue([{idHistoricoAtual:null},{indexHistoricoAtual:null}]),e.fixarHistoricoPadrao||k.setValue("historicoAtual",null),e.fixarHistoricoVariavel||k.setValue("historicoVariavel",null)}},Ue=()=>{const e=k.getValues(),o=[];if(Object(g.Xb)(e.data))o.push("Data de lan\xe7amento \xe9 de preenchimento obrigat\xf3rio");else{const t=Object(S.b)(e.data,a.globalParameter);null===t||t===P.c.label?parseInt(Object(g.Mb)(Object(g.tc)(e.data),"YYYY"),10)<1e3&&o.push("Lan\xe7amento deve ser posterior ao ano 1000"):o.push("Lan\xe7amento "+t)}Object(g.Xb)(e.valor)&&o.push("Valor deve ser maior que 0"),o.push(...(e=>{const a=[];return Object(g.Xb)(e.planoContaDebito)&&Object(g.Xb)(e.planoContaCredito)&&a.push("Contas: Nenhuma conta informada."),Object(g.Xb)(e.planoContaDebito)||Object(g.Xb)(e.planoContaCredito)||e.planoContaDebito.id!==e.planoContaCredito.id||a.push("Contas: D\xe9bito e Cr\xe9dito n\xe3o podem ser iguais."),a})(e)),o.push(...(e=>{const a=[];return 0===e.historicos.length&&(T.utilizarHistoricoPadrao&&T.utilizarHistoricoVariavel?Object(g.Xb)(e.historicoAtual)&&Object(g.Xb)(e.historicoVariavel)&&a.push("Hist\xf3rico Padr\xe3o/Vari\xe1vel: \xc9 necess\xe1rio ter pelo menos um hist\xf3rico para o lan\xe7amento."):(T.utilizarHistoricoPadrao&&Object(g.Xb)(e.historicoAtual)&&a.push("Hist\xf3rico Padr\xe3o: Campo n\xe3o pode estar em branco."),T.utilizarHistoricoVariavel&&Object(g.Xb)(e.historicoVariavel)&&a.push("Hist\xf3rico Vari\xe1vel: Campo n\xe3o pode estar em branco."))),a})(e)),o.push(...(e=>{const t=[],o=a.globalParameter.grupoPlanoConta.digitoAtivo,n=a.globalParameter.grupoPlanoConta.digitoPassivo;return Object(g.Xb)(e.planoContaDebito)||e.planoContaDebito.conta.charAt(0)===o||e.planoContaDebito.conta.charAt(0)===n||Object(g.Xb)(e.centroCustoDebito)&&t.push("Centro de Custo D\xe9bito n\xe3o pode estar em branco."),Object(g.Xb)(e.planoContaCredito)||e.planoContaCredito.conta.charAt(0)===o||e.planoContaCredito.conta.charAt(0)===n||Object(g.Xb)(e.centroCustoCredito)&&t.push("Centro de Custo Credito n\xe3o pode estar em branco."),t})(e)),o.push(...(e=>{const a=[];if(e.lancamentos.length>1&&(Object(g.Xb)(t.id)||!e.encerrado)){const t=(a,t)=>{let o=!1;return e.idLancamentoAtual?o=e.idLancamentoAtual!==a.id:e.indexLancamentoAtual&&(o=e.indexLancamentoAtual-1!==t),o};e.lancamentos.some((e,a)=>!Object(g.Xb)(e.planoContaDebito)&&!Object(g.Xb)(e.planoContaCredito)&&t(e,a))&&a.push("O lan\xe7amento de partida dobrada deve ser o \xfanico do lote.")}return a})(e)),Q&&Object(g.Xb)(e.efeitoPatrimonioLiquido)&&o.push("Motivo de Modifica\xe7\xe3o do Patrim\xf4nio L\xedquido - Campo n\xe3o pode estar em branco");const n=e.lancamentos.length>0?e.lancamentos[0].data:e.data;return 0!==Object(g.tb)(n,e.data)&&o.push("As datas dos lan\xe7amentos de mesmo lote n\xe3o podem ser diferentes."),o},Ye=()=>{let e=!0;const t=Ue();if(t.length>0)e=!1,g.ob.emit(g.a.SHOW,{message:c.a.createElement(g.C,{erros:t}),type:g.f.WARNING});else{Ke();const e=k.getValues();let t=e.lancamentos;const n=parseFloat(e.numeroLancamento),r={centroCustoCredito:e.centroCustoCredito,centroCustoDebito:e.centroCustoDebito,data:e.data,efeitoPatrimonioLiquido:Q?I.a.find(j,e.efeitoPatrimonioLiquido).extraFields.intValue:L.extraFields.intValue,empresa:a.globalParameter.empresa,empresaOrigem:a.globalParameter.empresa,encerrado:e.encerrado,historicos:e.historicos,numero:isNaN(n)?null:n,origem:V.a.extraFields.intValue,origemLancamento:V.a.extraFields.intValue,planoContaCredito:e.planoContaCredito,planoContaDebito:e.planoContaDebito,valor:e.valor};e.idLancamentoAtual||e.indexLancamentoAtual?t=t.map((a,t)=>{const n=e.idLancamentoAtual&&e.idLancamentoAtual===a.id,i=e.indexLancamentoAtual&&e.indexLancamentoAtual-1===t;let l=a;return(n||i)&&(l=Object(o.a)(Object(o.a)({},a),r)),l}):(r.lote={numero:e.numero},t.push(r)),me(!1),k.setValue([{lancamentos:t},{numeroLancamento:null},{lancamentoPadrao:null},{efeitoPatrimonioLiquido:null},{historicos:[]},{valor:null},{encerrado:!1},{idLancamentoAtual:null},{indexLancamentoAtual:null},{idHistoricoAtual:null},{indexHistoricoAtual:null}]);const i=(a,t)=>{e[t]||k.setValue(a,null)};i("data","fixarData"),i("planoContaDebito","fixarContaDebito"),i("centroCustoDebito","fixarCentroCustoDebito"),i("planoContaCredito","fixarContaCredito"),i("centroCustoCredito","fixarCentroCustoCredito"),i("historicoAtual","fixarHistoricoPadrao"),i("historicoVariavel","fixarHistoricoVariavel"),ye()}return e},Je=(e,a)=>(e.indice=a,e),Qe=(e,a)=>(e.indice=a,e.historicos=e.historicos.map(Je),delete e.lote,e),Ze=(e,t)=>{const o={idGerEmpresa:a.globalParameter.empresa.id,lancamentos:e.lancamentos.map(Qe)};Oe&&(o.id=Oe.id,o.numero=Oe.numero),t(o)},$e=(e,a,t=null)=>T&&T[e]&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"box-"+e,className:"lock-checkbox"},c.a.createElement(g.n,{id:e,formProps:k,onChange:()=>{const a=k.getValues();xe(t=>(t[e]=a[e],Object(o.a)({},t)))}}),c.a.createElement(r.a,{icon:De[e]?"lock":"lock-open"})),c.a.createElement(m.a,{placement:"bottom",target:"box-"+e},"Fixar ",t));return c.a.createElement(g.hb,{title:"Manuten\xe7\xe3o de Lan\xe7amentos",wikiId:2302},c.a.createElement(g.B,{formProps:k,editViewProps:e,dtoClassName:h,beforePersist:(e,a)=>{let t=!0;k.getValues().valor>0&&(t=Ye());const o=k.getValues();if(t&&0===o.lancamentos.length&&(g.ob.emit(g.a.SHOW,{message:"Lista de lan\xe7amentos n\xe3o pode estar vazia",type:g.f.INFORMATION}),t=!1),t){let e=0,t=0;o.lancamentos.forEach(a=>{a.planoContaDebito&&(e+=a.valor),a.planoContaCredito&&(t+=a.valor)}),e===t?Ze(o,a):T.validacaoLancPartidaSimples===x.b.value?g.ob.emit(g.a.SHOW,{message:"A soma dos valores \xe0 D\xe9bito diferem dos valores \xe0 Cr\xe9dito.",type:g.f.ERROR}):T.validacaoLancPartidaSimples===x.c.value?Ze(o,a):g.ob.emit(g.a.SHOW,{message:"A soma dos valores \xe0 D\xe9bito diferem dos valores \xe0 Cr\xe9dito. Deseja continuar?",onOkClick:()=>{Ze(o,a)},type:g.f.WARNING_YES_NO})}return{async:!0}},afterPersist:(e,t)=>{const o=a.globalParameter,n=o.empresa,r=o.empresaMLF,i=I.a.contains(v.e,n.tipoTributacao),l=r.configIRPJ&&r.configIRPJ.tipoApuracao===R.a.value,c=r.configCSLL&&r.configCSLL.tipoApuracao===R.a.value;if(i&&l&&c){const o=[];if(e.lancamentos.forEach(e=>{e.planoContaDebito&&o.push(e.planoContaDebito.conta),e.planoContaCredito&&o.push(e.planoContaCredito.conta)}),o.length>0){const n=Object(g.Nb)(Object(g.tc)(e.lancamentos[0].data));Object(N.O)({empresaMCG:a.globalParameter.empresaMFP,nomeContaCreditoDebito:o,referencia:n},{thenFunction:e=>{e?(e=>new Promise(t=>{g.ob.emit(g.a.SHOW,{message:"O lan\xe7amento interfere no c\xe1lculo de IRPJ ou CSLL j\xe1 calculado no sistema. \xc9 poss\xedvel que o procedimento de recalculo possa ser demorado. Deseja recalcular o IRPJ e CSLL desse ano j\xe1 apurado no sistema?",onNoClick:()=>t(),onOkClick:()=>{Object(N.b)({empresaMCG:a.globalParameter.empresaMCG,referencia:e},{thenFunction:()=>{t()}})},type:g.f.WARNING_YES_NO})}))(n).then(()=>t()):t()}})}else t()}else t();return{async:!0}},hideSubmitButton:Pe},te,Pe&&c.a.createElement("p",{style:{color:g.h},className:"text-center"},"Aten\xe7\xe3o: Lan\xe7amento Autom\xe1tico de Encerramento de Resultado. Esse lan\xe7amento n\xe3o pode ser alterado."),c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:k,id:"formaLancamento",inputDropDownProps:{optionsProvider:D.a},isPrependLabel:!0,label:"F\xf3rmula",placeholder:"Informe o Tipo de F\xf3rmula",type:g.L.DROP_DOWN,onChange:e=>{X(Object(o.a)(Object(o.a)({},T),{},{formaLancamento:e}))}})),c.a.createElement(b.a,null,c.a.createElement(w.a,{id:"configuracao",formProps:k,label:"Configura\xe7\xe3o",onChange:()=>{const e=k.getValues();e.configuracao&&(X(e.configuracao),k.setValue("formaLancamento",e.configuracao.formaLancamento))}}))),c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:k,isPrependLabel:!0,id:"numero",label:"N\xba Lote",tooltipProps:{message:"Preenchimento Opcional - Codifica\xe7\xe3o Autom\xe1tica"},disabled:Pe})),c.a.createElement(b.a,{md:4},c.a.createElement(g.K,{formProps:k,isPrependLabel:!0,id:"numeroLancamento",label:"N\xba Lan\xe7amento",tooltipProps:{message:"Preenchimento Opcional - Codifica\xe7\xe3o Autom\xe1tica"},disabled:Pe}))),c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:k,isPrependLabel:!0,id:"data",label:"Data do Lan\xe7amento",type:g.L.DATE,disabled:De.fixarData||Pe,onBlur:ye})),$e("fixarData",0,"Data de Lan\xe7amento"),c.a.createElement(b.a,{className:Object(i.a)({bloqueado:!!K})},c.a.createElement(g.K,{formProps:k,isPrependLabel:!0,id:"referencia",label:"Referencia",disabled:!0,tooltipProps:K&&{message:"Lan\xe7amento "+K}}))),c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(y,{id:"lancamentoPadrao",formProps:k,label:"Lan\xe7amento Padr\xe3o",onChange:e=>{if(e){const t=k.getValues().data||Object(g.Mb)(Object(g.ic)(a.globalParameter.empresaMCG.refAtual,1));oe(c.a.createElement(Z,{dataLancamento:t,globalParameter:a.globalParameter,lancamentoConfig:T,lotePadrao:e,onClose:We,onConfirm:qe}))}},disabled:Pe}))),c.a.createElement(g.g,{title:"D\xe9bito"},c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(_.a,{id:"planoContaDebito",formProps:k,label:"Conta",disabled:De.fixarContaDebito||Pe,onChange:Ge})),$e("fixarContaDebito",0,"Conta de D\xe9bito"),T&&T.exibirSaldoContas?c.a.createElement("div",{style:{paddingRight:20,width:200,marginLeft:15}},c.a.createElement(C.a,{innerRef:k.register,name:"somaDebito",id:"somaDebito",disabled:!0})):c.a.createElement("div",{style:{paddingRight:20,marginLeft:15}},c.a.createElement(p.a,{id:"somaDebito",style:{width:80},onClick:()=>Me(null,!0)},"Saldo"))),T&&T.utilizarCentroCusto&&c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(H.a,{id:"centroCustoDebito",formProps:k,label:"Centro de Custo",disabled:De.fixarCentroCustoDebito||Ne.centroCustoDebito||Pe})),$e("fixarCentroCustoDebito",0,"Centro de Custo"))),c.a.createElement(g.g,{title:"Cr\xe9dito"},c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(_.a,{id:"planoContaCredito",formProps:k,label:"Conta",disabled:De.fixarContaCredito||Pe,onChange:Be})),$e("fixarContaCredito",0,"Conta de Cr\xe9dito"),T&&T.exibirSaldoContas?c.a.createElement("div",{style:{paddingRight:20,width:200,marginLeft:15}},c.a.createElement(C.a,{innerRef:k.register,name:"somaCredito",id:"somaCredito",disabled:!0})):c.a.createElement("div",{style:{paddingRight:20,marginLeft:15}},c.a.createElement(p.a,{id:"somaCredito",style:{width:80},onClick:()=>ze(null,!0)},"Saldo"))),T&&T.utilizarCentroCusto&&c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(H.a,{id:"centroCustoCredito",formProps:k,label:"Centro de Custo",disabled:De.fixarCentroCustoCredito||Ne.centroCustoCredito||Pe})),$e("fixarCentroCustoCredito",0,"Centro de Custo"))),Q&&c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(g.K,{formProps:k,id:"efeitoPatrimonioLiquido",inputDropDownProps:{optionsProvider:j},isPrependLabel:!0,label:"Motivo de Modifica\xe7\xe3o do Patrim\xf4nio L\xedquido",type:g.L.DROP_DOWN}))),c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(F.a,{id:"historicoAtual",formProps:k,label:"Hist\xf3rico Padr\xe3o",disabled:De.fixarHistoricoPadrao||Pe})),$e("fixarHistoricoPadrao",0,"Hist\xf3rico")),c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(f.a,{className:"historico-variavel"},c.a.createElement(E.a,{className:"card-header pr-2"},c.a.createElement("div",{className:"card-header--title"},"Hist\xf3rico Vari\xe1vel"),c.a.createElement("div",{className:"card-header--actions"},T&&T.historico===A.c.value&&c.a.createElement(c.a.Fragment,null,c.a.createElement(p.a,{id:"incluirHistorico",size:"sm",color:"link",className:Ce?"text-primary":"text-success",onClick:Ke},c.a.createElement(r.a,{icon:Ce?"save":"plus"})),c.a.createElement(m.a,{placement:"bottom",target:"incluirHistorico"},Ce?"Salvar Altera\xe7\xf5es":"Incluir Hist\xf3rico")),c.a.createElement(p.a,{id:"exibirHistorico",size:"sm",color:"link",className:"text-warning",onClick:()=>{const e=k.getValues();g.ob.emit(g.a.SHOW,{message:Object(S.a)(e.historicos),type:g.f.INFORMATION})}},c.a.createElement(r.a,{icon:"link"})),c.a.createElement(m.a,{placement:"bottom",target:"exibirHistorico"},"Exibir hist\xf3rico concatenado"),$e("fixarHistoricoVariavel",0,"Hist\xf3rico Vari\xe1vel"))),c.a.createElement(O.a,null,c.a.createElement(C.a,{type:"textarea",name:"historicoVariavel",innerRef:k.register,disabled:De.fixarHistoricoVariavel||Pe,placeholder:"Hist\xf3rico Vari\xe1vel"}))))),T&&T.historico===A.c.value&&c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(G,{formProps:k,onEdit:e=>ke(e),onRemove:e=>{g.ob.emit(g.a.SHOW,{message:"Deseja mesmo remover este hist\xf3rico?",onOkClick:()=>{const a=k.getValues();k.setValue("historicos",a.historicos.filter((a,t)=>{const o=e.id&&a.id&&e.id===a.id,n=e.rowIndex&&e.rowIndex-1===t;return!o&&!n}))},type:g.f.WARNING_YES_NO})},disabled:Pe}))),c.a.createElement(u.a,null,c.a.createElement(b.a,{md:4},c.a.createElement(g.K,{formProps:k,isPrependLabel:!0,id:"valor",label:"Valor",type:g.L.MONEY,disabled:Pe})),T&&T.formaLancamento!==D.c.value&&c.a.createElement("div",null,c.a.createElement(p.a,{color:de?"primary":"success",onClick:Ye,disabled:Pe},de?"Alterar":"Incluir")),c.a.createElement(b.a,{style:{paddingTop:10},className:"text-right"},ie&&c.a.createElement("p",{className:"d-inline-block pr-4",style:{color:g.h}},"Registro inclu\xeddo em ",ie),c.a.createElement(g.n,{id:"encerrado",formProps:k,label:"Conta de Encerramento"}))),T&&T.formaLancamento!==D.c.value&&c.a.createElement(u.a,null,c.a.createElement(b.a,null,c.a.createElement(q,{formProps:k,lancamentoConfig:T,empresaMCG:a.globalParameter.empresaMCG,onEdit:e=>Fe(e),onRemove:e=>{g.ob.emit(g.a.SHOW,{message:"Deseja mesmo remover este lancamento?",onOkClick:()=>{const a=k.getValues();k.setValue("lancamentos",a.lancamentos.filter((a,t)=>{const o=e.id&&a.id&&e.id===a.id,n=e.rowIndex&&e.rowIndex-1===t;return!o&&!n}))},type:g.f.WARNING_YES_NO})},disabled:Pe,numeroLote:Oe&&Oe.numero||null})))))})},1131:function(e,a,t){},1132:function(e,a,t){},1133:function(e,a,t){},878:function(e,a,t){"use strict";t.d(a,"a",function(){return o});const o="br.com.projetusinformatica.calima.mcg.model.dto.historico"},888:function(e,a,t){"use strict";t.d(a,"a",function(){return o});const o="br.com.projetusinformatica.calima.mcg.model.dto.lancamentomcgconfig"},895:function(e,a,t){"use strict";t.d(a,"b",function(){return o}),t.d(a,"c",function(){return s}),t.d(a,"d",function(){return d}),t.d(a,"a",function(){return m}),t.d(a,"e",function(){return u});const o={value:"lucroReal",label:"Lucro Real"},n={value:"lucroRealArbitrado",label:"Lucro Real/Arbitrado"},r={value:"lucroPresumidoRealArbitrado",label:"Lucro Presumido/Real/Arbitrado"},i={value:"lucroPresumido",label:"Lucro Presumido"},l={value:"imune",label:"Imune do IRPJ"},c={value:"isento",label:"Isenta do IRPJ"},s={value:"simplesNacional",label:"Simples Nacional"},d=[l,c,{value:"lucroArbitrado",label:"Lucro Arbitrado"},i,{value:"lucroPresumidoArbitrado",label:"Lucro Presumido/Arbitrado"},{value:"lucroPresumidoReal",label:"Lucro Presumido/Real"},r,o,n,s],m=[o,i,c,l,s],u=[o,n,r]},900:function(e,a,t){"use strict";var o=t(6),n=t(0),r=t.n(n),i=t(2),l=t(878);a.a=(e=>r.a.createElement(i.K,Object.assign({},e,{formProps:Object(o.a)({},e.formProps),isPrependLabel:!0,inputSearchProps:Object(o.a)(Object(o.a)({},e.inputSearchProps),{},{columns:[{dataField:"codigo",text:"C\xf3digo"},{dataField:"descricao",text:"Descri\xe7\xe3o"}],dtoClassName:l.a,searchViewId:"HistoricoSearchView"}),label:e.label?e.label:"Hist\xf3rico",placeholder:e.placeholder?e.placeholder:"Informe o Hist\xf3rico",type:i.L.INPUT_SEARCH})))},938:function(e,a,t){"use strict";t.d(a,"a",function(){return o}),t.d(a,"b",function(){return n});const o={label:"Cont\xe1bil",value:"CONTABIL"},n=[o,{label:"Fiscal",value:"FISCAL"}]},940:function(e,a,t){"use strict";t.d(a,"a",function(){return o});const o="br.com.projetusinformatica.calima.mcg.model.dto.lotepadrao"}}]);
//# sourceMappingURL=2.3087ab88.chunk.js.map